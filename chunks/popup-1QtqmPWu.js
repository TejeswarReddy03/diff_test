import{v as H,b as J,c as X,V as Y,a as Z}from"./tailwind-C6GlUj0q.js";import{ap as m,aG as u,ax as s,ae as P,af as e,b as V,aA as r,G as i,aI as v,L as ee,aj as $,aw as T,aq as D,az as E,aM as te,am as A,an as G,aN as q,aO as j,at as se,aP as Q,ay as B,aC as ne,aQ as K,C as S,aR as oe,aS as ae,aT as re,aU as ie,aV as U,c as le,aW as ue,d as ce,aX as pe,aY as me,aZ as de,D as fe,a_ as _e,F as ge,T as be,h as he,a$ as ve,as as M,r as ye,aJ as W,aK as ke,aL as $e}from"./_virtual_wxt-plugins-CgS_BGdF.js";import{_ as we,a as Te,b as Pe,c as Se}from"./ActiveToggle.vue_vue_type_script_setup_true_lang-CsbDE9lW.js";import{g as C}from"./extension-url-Dkf82Rp_.js";import{u as Ce}from"./useMutation-BhQfRMH1.js";import{p as Oe}from"./immer-CwDZyRGJ.js";import{u as Ae}from"./useAddAllowedPatternMutation-8sBoonnL.js";import{_ as Ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Be,_ as Ue}from"./Logo.vue_vue_type_script_setup_true_lang-CEkG35my.js";import"./birth-year-prompt-utils-BdmaBzBB.js";const Re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function xe(c,t){return u(),m("svg",Re,t[0]||(t[0]=[s("path",{fill:"currentColor",d:"M14 3v2h3.59l-9.83 9.83l1.41 1.41L19 6.41V10h2V3m-2 16H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7h-2z"},null,-1)]))}const Me={name:"mdi-open-in-new",render:xe},Le={class:"p-4 flex gap-0 justify-between text-sm"},Fe=["href"],Ie=["src"],Ne=["href"],Ve=["href"],De=["href"],Ee=["href"],qe=P({__name:"PopupFooter",setup(c){return(t,n)=>(u(),m("div",Le,[s("a",{class:"flex items-center gap-2 link link-hover",href:("getOptionsPage"in t?t.getOptionsPage:e(C))("nuclear"),target:"_blank"},[s("img",{src:("browser"in t?t.browser:e(V)).runtime.getURL("/icon-nuclear-16.png")},null,8,Ie),s("span",null,r(("t"in t?t.t:e(i))("nuclearMode")),1)],8,Fe),n[1]||(n[1]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"link link-hover",href:("getOptionsPage"in t?t.getOptionsPage:e(C))(),target:"_blank"},[s("span",null,r(("t"in t?t.t:e(i))("dashboard")),1)],8,Ne),n[2]||(n[2]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"link link-hover",href:("getOptionsPage"in t?t.getOptionsPage:e(C))("settings"),target:"_blank"},[s("span",null,r(("t"in t?t.t:e(i))("settings")),1)],8,Ve),n[3]||(n[3]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"link link-hover",href:("getOptionsPage"in t?t.getOptionsPage:e(C))("help"),target:"_blank"},[s("span",null,r(("t"in t?t.t:e(i))("helpFaq")),1)],8,De),n[4]||(n[4]=s("span",{class:"opacity-50"},"•",-1)),s("a",{class:"flex gap-2 items-center link link-hover link-accent text-sm",href:("Links"in t?t.Links:e(ee)).Discord,target:"_blank"},[n[0]||(n[0]=s("span",null,"Discord",-1)),v(e(Me))],8,Ee)]))}}),je={class:"font-bold uppercase"},Qe=P({__name:"MutationTimerResult",props:{mutationResult:{}},setup(c){const t=c,n=$(()=>{if(t.mutationResult){if(t.mutationResult.status=="success")return i("success");if(t.mutationResult.status=="failed")return i("failed")}});return(l,p)=>l.mutationResult?(u(),m("p",{key:0,class:D(["text-sm",{"text-success":l.mutationResult.status=="success","text-error":l.mutationResult.status==="failed"}])},[s("span",je,r(e(n)),1),E(" "+r(l.mutationResult.message),1)],2)):T("",!0)}}),Ke={class:"flex flex-row"},We={for:"groups-source",class:"lg:block m-auto text-base-content/80"},ze=["value"],He=P({__name:"BlockedGroupsSelector",emits:["selectGroup"],setup(c,{emit:t}){const n=t,{groups:l}=te(),p=A("");G(l,()=>{l.value&&(p.value=l.value.find(d=>d.customLimitName==q).id)});function _(){n("selectGroup",p.value)}return(d,g)=>(u(),m("div",Ke,[s("label",We,[s("small",null,r(("t"in d?d.t:e(i))("group"))+":",1)]),j(s("select",se({id:"groups-source",class:"select select-sm select-primary select-bordered ml-3 w-full"},e(l),{"onUpdate:modelValue":g[0]||(g[0]=o=>Q(p)?p.value=o:null),onChange:_}),[(u(!0),m(B,null,ne(e(l),o=>(u(),m("option",{key:o.id,value:o.id},r(o.customLimitName),9,ze))),128))],16),[[H,e(p)]])]))}});function Je(){const c=K();return Ce({mutationFn:async({timer:t,pattern:n})=>{const l=await c.timers.getAllTimersByType(S.Group),p=oe(l),_=ae(re(n)),d=ie(p,[_]);if(d.result){const g=Oe(t,o=>{var b;(b=o.blocklist)==null||b.push(_)});return await c.timers.upsertTimer(g),{status:"success"}}else return{status:"failed",message:d.message}}})}function L(){const{state:c}=U(le),t=$(()=>c.value?ue(c.value):"-");return{currentUrl:c,hostname:t}}function Xe(){const{state:c}=U(ce);return $(()=>{const n=Object.values(c.value).find(l=>l.name==q);if(n)return n.id})}const Ye={class:"collapse collapse-arrow rounded-none"},Ze={class:"collapse-title text-sm min-h-8 p-3 ml-1"},et={class:"collapse-content flex flex-col gap-4"},tt={class:"flex gap-4"},st={class:"flex gap-4"},nt={class:"text-sm"},ot={class:"flex gap-4"},at=P({__name:"PopupBlockForm",setup(c){const{data:t}=pe(),{state:n}=U(me),{mutate:l,isSuccess:p,data:_}=Je();function d(a){var O;const f=(O=t.value)==null?void 0:O.find(k=>k.timer.id==R.value);if(!a||!f)return;const x=f.timer;l({pattern:a,timer:x})}const{mutate:g,isSuccess:o,data:b}=Ae();function y(a){a&&g({pattern:a})}G(o,a=>{a&&(w.value=b.value)}),G(p,a=>{a&&(w.value=_.value)});const h=A(""),w=A(),{currentUrl:F,hostname:I}=L(),N=Xe(),R=A("");G(N,()=>R.value=N.value??"");function z(a){R.value=a}return(a,f)=>{const x=He,O=Qe;return u(),m("details",Ye,[s("summary",Ze,r(("t"in a?a.t:e(i))("popup_advancedBlockingOptions")),1),s("div",et,[v(x,{onSelectGroup:z}),v(O,{"mutation-result":e(w)},null,8,["mutation-result"]),s("div",tt,[s("button",{type:"button",class:"flex-1 btn btn-sm btn-error",onClick:f[0]||(f[0]=k=>d(e(I)))},r(("t"in a?a.t:e(i))("popup_blockEntireSite")),1),e(n)?T("",!0):(u(),m("button",{key:0,type:"button",class:"flex-1 btn btn-sm btn-success",onClick:f[1]||(f[1]=k=>y(e(I)))},r(("t"in a?a.t:e(i))("popup_allowEntireSite")),1))]),s("div",st,[s("button",{type:"button",class:"flex-1 btn btn-sm btn-error",onClick:f[2]||(f[2]=k=>d(e(F)))},r(("t"in a?a.t:e(i))("popup_blockUrl")),1),e(n)?T("",!0):(u(),m("button",{key:0,type:"button",class:"flex-1 btn btn-sm btn-success",onClick:f[3]||(f[3]=k=>y(e(F)))},r(("t"in a?a.t:e(i))("popup_allowUrl")),1))]),s("p",nt,r(("t"in a?a.t:e(i))("popup_enterCustomUrl")),1),j(s("input",{class:"input input-sm input-bordered focus:input-primary",type:"text",placeholder:"URL","onUpdate:modelValue":f[4]||(f[4]=k=>Q(h)?h.value=k:null)},null,512),[[J,e(h)]]),s("div",ot,[s("button",{type:"button",class:"flex-1 btn btn-sm btn-error",onClick:f[5]||(f[5]=k=>d(e(h)))},r(("t"in a?a.t:e(i))("popup_blockCustomUrl")),1),e(n)?T("",!0):(u(),m("button",{key:0,type:"button",class:"flex-1 btn btn-sm btn-success",onClick:f[6]||(f[6]=k=>y(e(h)))},r(("t"in a?a.t:e(i))("popup_allowCustomUrl")),1))])])])}}}),rt=Ge(at,[["__scopeId","data-v-49cc260a"]]);function it(){const c=K(),{currentUrl:t}=L();return de({queryKey:[_e.GetPopupTimer],queryFn:()=>t.value?c.timers.getPopupTimer(t.value):null,refetchInterval:fe.SECOND.ms,refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0})}const lt={class:"uppercase text-xs opacity-70 whitespace-nowrap"},ut={class:"text-xl font-bold"},ct={key:1,class:"text-xl font-bold"},pt={class:"uppercase text-xs opacity-70 whitespace-nowrap"},mt={class:"flex items-baseline gap-2 justify-end","data-testid":"display-timer"},dt={class:"text-2xl font-bold"},ft=P({__name:"CurrentTimer",setup(c){const{data:t}=it(),n=$(()=>{var o;return(o=t.value)==null?void 0:o.timer.type}),l=$(()=>n.value==S.Group),p=$(()=>{var o;return(o=t.value)==null?void 0:o.timer.name}),_=$(()=>{var o;return((o=t.value)==null?void 0:o.timer.type)==S.Nuclear}),d=$(()=>{switch(n.value){case S.Group:return i("group");case S.Nuclear:return i("nuclear");case S.BlockAll:return i("blockAll")}}),g=$(()=>{if(t.value){const o=t.value.timeLeftMs,b=ge(o<be.Second?0:o);return`${b.hours==0?"":`${b.hours}:`}${b.minutes}:${b.seconds}`}});return(o,b)=>{var y,h,w;return e(t)?(u(),m("div",{key:0,class:D(["rounded self-center px-3 py-2 text-right min-w-32",{"bg-success text-white":!e(_)&&((y=e(t))==null?void 0:y.relation)==="allowed","bg-error text-white":!e(_)&&((h=e(t))==null?void 0:h.relation)==="blocked","bg-nuclear text-nuclear":e(_),"bg-neutral text-primary":!e(_)&&((w=e(t))==null?void 0:w.relation)==null}])},[s("div",null,[e(l)?(u(),m(B,{key:0},[s("p",lt,r(("t"in o?o.t:e(i))("group")),1),s("p",ut,r(e(p)),1)],64)):(u(),m("p",ct,r(e(d)),1))]),s("p",pt,r(("t"in o?o.t:e(i))("timeRemaining")),1),s("div",mt,[s("p",dt,r(e(g)),1)])],2)):T("",!0)}}}),_t={class:"flex gap-4 px-4 py-2 min-w-[100%]"},gt={class:"flex-1 flex flex-col"},bt={class:"text-sm opacity-50","data-testid":"currently-on"},ht={class:"text-lg font-bold truncate"},vt={class:"text-sm truncate"},yt=P({__name:"PopupActivated",setup(c){const{currentUrl:t,hostname:n}=L();return(l,p)=>{const _=ft,d=rt,g=qe;return u(),m(B,null,[s("section",_t,[s("div",gt,[s("p",bt,r(("t"in l?l.t:e(i))("youAreCurrentlyOn")),1),s("p",ht,r(e(n)),1),s("p",vt,r(e(t)),1)]),v(_)]),v(d),v(g)],64)}}}),kt={class:"flex flex-col gap-4 justify-center p-5 px-8 bg-base-100"},$t={class:"text-lg font-bold"},wt={class:"text-base"},Tt=P({__name:"ActionRequired",setup(c){function t(){V.tabs.create({url:C(),active:!0})}return(n,l)=>(u(),m("div",kt,[s("h1",$t,r(("t"in n?n.t:e(i))("required")),1),s("p",wt,r(("t"in n?n.t:e(i))("tosHaveChanged")),1),s("button",{class:"btn btn-primary","data-testid":"btn-open-settings",onClick:t},r(("t"in n?n.t:e(i))("openSettings")),1)]))}}),Pt={class:"w-[32rem] divide-y divide-base-content divide-opacity-10"},St={class:"flex justify-between items-baseline"},Ct=["href"],Ot=P({__name:"App",setup(c){Be();const t=ye(),{state:n}=U(he),l=ve(async()=>await t.isOnboardingCompleted());return(p,_)=>{const d=Tt,g=Ue,o=we,b=Te,y=Se,h=yt,w=Pe;return u(),m("div",Pt,[e(l)?(u(),m(B,{key:1},[s("div",St,[s("div",null,[v(g,{height:45}),v(o)]),e(n)?(u(),m("a",{key:0,class:"link link-hover mr-4 text-sm",href:("getOptionsPage"in p?p.getOptionsPage:e(C))("stayfree-pairing"),target:"_blank"},[v(b),E(r(("t"in p?p.t:e(i))("pairWithMobile")),1)],8,Ct)):T("",!0)]),e(n)?T("",!0):(u(),M(y,{key:0})),e(n)?(u(),M(h,{key:1})):T("",!0),v(w)],64)):(u(),M(d,{key:0}))])}}});W.page(location.href);W.autoTrack(document);X(Ot).use(ke()).use(Y).provide($e.Stayfocusd,Z()).mount("#app");
